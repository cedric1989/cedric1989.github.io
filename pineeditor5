//@version=5 indicator("Gelismis UT Bot - Kapsamli Analiz", shorttitle="UT Bot TR", overlay=true) // ==================== GIRIS PARAMETRELERI ==================== grup1 = "Ana Ayarlar" hassasiyet = input.float(1.0, title="Hassasiyet Degeri", minval=0.1, maxval=5.0, step=0.1, group=grup1, tooltip="Dusuk deger = Daha fazla sinyal, Yuksek deger = Daha az sinyal") atr_periyot = input.int(10, title="ATR Periyodu", minval=1, maxval=50, group=grup1) heikin_ashi = input.bool(false, title="Heikin Ashi Kullan", group=grup1) grup2 = "Trend Analizi" trend_gosterimi = input.bool(true, title="Trend Analizi Goster", group=grup2) trend_periyot = input.int(20, title="Trend EMA Periyodu", minval=5, maxval=200, group=grup2) guc_analizi = input.bool(true, title="Guc Analizi Goster", group=grup2) grup3 = "Gorsel Ayarlar" bar_renklendirme = input.bool(true, title="Barlari Renklendir", group=grup3) sinyal_boyutu = input.string("Normal", title="Sinyal Boyutu", options=["Kucuk","Normal","Buyuk"], group=grup3) yuzde_gosterimi = input.bool(true, title="Yuzde Degisimini Goster", group=grup3) grup4 = "Uyari Ayarlari" guclu_sinyal = input.bool(true, title="Guclu Sinyalleri Filtrele", group=grup4) volume_filtresi = input.bool(true, title="Volume Filtresi", group=grup4) min_volume_kat = input.float(1.5, title="Min Volume Kati", minval=1.0, maxval=5.0, group=grup4) // ==================== HEIKIN ASHI HESAPLAMALARI ==================== var float ha_acilis = na ha_kapanis = (open + high + low + close) / 4 ha_acilis := na(ha_acilis[1]) ? open : (ha_acilis[1] + ha_kapanis[1]) / 2 ha_yuksek = math.max(high, math.max(ha_acilis, ha_kapanis)) ha_dusuk = math.min(low, math.min(ha_acilis, ha_kapanis)) kaynak = heikin_ashi ? ha_kapanis : close // ==================== ATR VE TRAILING STOP ==================== atr_degeri = ta.atr(atr_periyot) zarar_mesafesi = hassasiyet * atr_degeri var float trailing_stop = na trailing_stop := if (kaynak > nz(trailing_stop[1], 0) and kaynak[1] > nz(trailing_stop[1], 0)) math.max(nz(trailing_stop[1]), kaynak - zarar_mesafesi) else if (kaynak < nz(trailing_stop[1], 0) and kaynak[1] < nz(trailing_stop[1], 0)) math.min(nz(trailing_stop[1]), kaynak + zarar_mesafesi) else if (kaynak > nz(trailing_stop[1], 0)) kaynak - zarar_mesafesi else kaynak + zarar_mesafesi // ==================== POZISYON BELIRLEME ==================== var int pozisyon = 0 pozisyon := if (kaynak[1] < nz(trailing_stop[1], 0) and kaynak > nz(trailing_stop[1], 0)) 1 else if (kaynak[1] > nz(trailing_stop[1], 0) and kaynak < nz(trailing_stop[1], 0)) -1 else nz(pozisyon[1], 0) // ==================== TREND ANALIZI ==================== trend_ema = ta.ema(kaynak, trend_periyot) uzun_trend = kaynak > trend_ema kisa_trend = kaynak < trend_ema trend_gucu = math.abs(kaynak - trend_ema) / trend_ema * 100 // ==================== VOLUME ANALIZI ==================== ortalama_volume = ta.sma(volume, 20) yuksek_volume = volume > (ortalama_volume * min_volume_kat) // ==================== SINYAL BELIRLEME ==================== ema_hizli = ta.ema(kaynak, 1) yukari_gecis = ta.crossover(ema_hizli, trailing_stop) asagi_gecis = ta.crossover(trailing_stop, ema_hizli) temel_alis = kaynak > trailing_stop and yukari_gecis temel_satis = kaynak < trailing_stop and asagi_gecis guclu_alis_filtresi = guclu_sinyal ? (uzun_trend and trend_gucu > 0.5) : true guclu_satis_filtresi = guclu_sinyal ? (kisa_trend and trend_gucu > 0.5) : true volume_alis_filtresi = volume_filtresi ? yuksek_volume : true volume_satis_filtresi = volume_filtresi ? yuksek_volume : true alis_sinyali = temel_alis and guclu_alis_filtresi and volume_alis_filtresi satis_sinyali = temel_satis and guclu_satis_filtresi and volume_satis_filtresi var bool son_alis = false var bool son_satis = false onaylanmis_alis = alis_sinyali and not son_alis onaylanmis_satis = satis_sinyali and not son_satis if onaylanmis_alis son_alis := true son_satis := false else if onaylanmis_satis son_satis := true son_alis := false // ==================== YUZDE DEGISIM HESAPLAMALARI ==================== fiyat_degisimi = ((close - close[1]) / close[1]) * 100 gunluk_degisim = ((close - open) / open) * 100 // ==================== GORSELLESTIRME ==================== // Boyut seçimi (const gereksinimi nedeniyle üç ayrı plotshape) isKucuk = sinyal_boyutu == "Kucuk" isNormal = sinyal_boyutu == "Normal" isBuyuk = sinyal_boyutu == "Buyuk" trend_durumu = uzun_trend ? "Yukselis Trendi" : "Dusus Trendi" trend_guc_metni = trend_gucu > 2.0 ? "Guclu" : trend_gucu > 1.0 ? "Orta" : "Zayif" // ALIS işaretleri plotshape(onaylanmis_alis and isKucuk, title="Guclu Alis Sinyali K", text="ALIS", style=shape.labelup, location=location.belowbar, color=color.new(color.green, 0), textcolor=color.white, size=size.tiny) plotshape(onaylanmis_alis and isNormal, title="Guclu Alis Sinyali N", text="ALIS", style=shape.labelup, location=location.belowbar, color=color.new(color.green, 0), textcolor=color.white, size=size.small) plotshape(onaylanmis_alis and isBuyuk, title="Guclu Alis Sinyali B", text="ALIS", style=shape.labelup, location=location.belowbar, color=color.new(color.green, 0), textcolor=color.white, size=size.normal) // SATIS işaretleri plotshape(onaylanmis_satis and isKucuk, title="Guclu Satis Sinyali K", text="SATIS", style=shape.labeldown, location=location.abovebar, color=color.new(color.red, 0), textcolor=color.white, size=size.tiny) plotshape(onaylanmis_satis and isNormal, title="Guclu Satis Sinyali N", text="SATIS", style=shape.labeldown, location=location.abovebar, color=color.new(color.red, 0), textcolor=color.white, size=size.small) plotshape(onaylanmis_satis and isBuyuk, title="Guclu Satis Sinyali B", text="SATIS", style=shape.labeldown, location=location.abovebar, color=color.new(color.red, 0), textcolor=color.white, size=size.normal) // Çizgiler plot(trailing_stop, title="ATR Trailing Stop", color=color.new(color.blue, 30), linewidth=2) plot(trend_gosterimi ? trend_ema : na, title="Trend EMA", color=color.new(color.orange, 50), linewidth=1) // Bar renklendirme barcolor(bar_renklendirme ? (onaylanmis_alis ? color.green : onaylanmis_satis ? color.red : uzun_trend ? color.new(color.green, 80) : color.new(color.red, 80)) : na) // Günlük yüzde etiketi (opsiyonel) var label yuzde_lbl = na if barstate.islast if not na(yuzde_lbl) label.delete(yuzde_lbl) if yuzde_gosterimi yuzde_lbl := label.new(bar_index, close, text="%" + str.tostring(gunluk_degisim, "#.##"), style=label.style_label_right, textcolor=color.white, color=gunluk_degisim > 0 ? color.new(color.green, 0) : color.new(color.red, 0), size=size.small) // ==================== TABLO GOSTERIMI ==================== if guc_analizi var table bilgi_tablosu = table.new(position.top_right, 2, 6, bgcolor=color.new(color.white, 80)) if barstate.islast table.cell(bilgi_tablosu, 0, 0, "ANALIZ", text_color=color.black, text_size=size.small) table.cell(bilgi_tablosu, 1, 0, "DEGER", text_color=color.black, text_size=size.small) table.cell(bilgi_tablosu, 0, 1, "Trend Durumu", text_color=color.black) table.cell(bilgi_tablosu, 1, 1, trend_durumu, text_color=uzun_trend ? color.green : color.red) table.cell(bilgi_tablosu, 0, 2, "Trend Gucu", text_color=color.black) table.cell(bilgi_tablosu, 1, 2, trend_guc_metni + " (%" + str.tostring(trend_gucu, "#.##") + ")", text_color=trend_gucu > 1.0 ? color.green : color.orange) table.cell(bilgi_tablosu, 0, 3, "Gunluk Degisim", text_color=color.black) table.cell(bilgi_tablosu, 1, 3, "%" + str.tostring(gunluk_degisim, "#.##"), text_color=gunluk_degisim > 0 ? color.green : color.red) table.cell(bilgi_tablosu, 0, 4, "Volume Durumu", text_color=color.black) table.cell(bilgi_tablosu, 1, 4, yuksek_volume ? "Yuksek" : "Normal", text_color=yuksek_volume ? color.green : color.gray) table.cell(bilgi_tablosu, 0, 5, "ATR Degeri", text_color=color.black) table.cell(bilgi_tablosu, 1, 5, str.tostring(atr_degeri, "#.####"), text_color=color.blue) // ==================== UYARI KOSULLARI (SABIT MESAJLAR) ==================== alertcondition(onaylanmis_alis, "Guclu Alis Sinyali", "GUCLU ALIS SINYALI!\nSembol: {{ticker}}\nFiyat: {{close}}\nZaman: {{time}}") alertcondition(onaylanmis_satis, "Guclu Satis Sinyali", "GUCLU SATIS SINYALI!\nSembol: {{ticker}}\nFiyat: {{close}}\nZaman: {{time}}") alertcondition(onaylanmis_alis and yuksek_volume and uzun_trend, "Super Guclu Alis", "SUPER GUCLU ALIS SINYALI!\nTum kosullar saglandi!\nSembol: {{ticker}}\nFiyat: {{close}}") alertcondition(onaylanmis_satis and yuksek_volume and kisa_trend, "Super Guclu Satis", "SUPER GUCLU SATIS SINYALI!\nTum kosullar saglandi!\nSembol: {{ticker}}\nFiyat: {{close}}")
